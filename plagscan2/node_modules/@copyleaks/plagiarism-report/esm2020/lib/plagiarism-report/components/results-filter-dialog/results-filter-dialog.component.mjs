import { Component, Inject } from '@angular/core';
import { MAT_DIALOG_DATA } from '@angular/material/dialog';
import { take } from 'rxjs/operators';
import { untilDestroy } from '../../../shared/operators/untilDestroy';
import { truthy } from '../../utils/operators';
import * as i0 from "@angular/core";
import * as i1 from "../../services/copyleaks-translate.service";
import * as i2 from "@angular/material/dialog";
import * as i3 from "../../services/direction.service";
import * as i4 from "@angular/cdk/a11y";
import * as i5 from "@angular/material/form-field";
import * as i6 from "@angular/material/icon";
import * as i7 from "@angular/material/checkbox";
import * as i8 from "@angular/material/button";
import * as i9 from "@angular/material/input";
import * as i10 from "@angular/forms";
import * as i11 from "@angular/common";
import * as i12 from "@angular/flex-layout/flex";
import * as i13 from "../../../shared/pipes/search.pipe";
import * as i14 from "../../services/report.service";
export class ResultsFilterDialogComponent {
    constructor(translatesService, dialogRef, directionService, reportSerivce, announcer) {
        this.translatesService = translatesService;
        this.dialogRef = dialogRef;
        this.directionService = directionService;
        this.reportSerivce = reportSerivce;
        this.announcer = announcer;
        this.query = '';
        this.hidden = [];
        this.checkedAllResults = false;
    }
    /**
     * Checks whether the hidden results contain a `result`
     * @param result the result to test
     */
    isHidden(result) {
        return this.hidden.includes(result.id);
    }
    /**
     * Adds or removes the `result` from the hidden results list essentialy checks or unchecks it
     * @param result the result to check/uncheck
     */
    toggleResult(result) {
        const index = this.hidden.indexOf(result.id);
        if (index > -1) {
            this.hidden.splice(index, 1);
        }
        else {
            this.hidden.push(result.id);
        }
    }
    /**
     * Checks or unchecks all results
     */
    checkAll() {
        if (this.hidden.length !== this.results.length) {
            this.hidden = [...this.results.map(r => r.id)];
        }
        else {
            this.hidden = [];
        }
        this.checkedAllResults = !this.checkedAllResults;
        this.announcer.announce(this.checkedAllResults ? 'All results unchecked' : 'All results checked', 'assertive');
    }
    /**
     * Closes the dialog while indicating whether to `save` changes or not.
     */
    close(save) {
        this.dialogRef.close(save);
    }
    /**
     * Saves the hidden results changes
     */
    saveChanges() {
        this.reportSerivce.setHiddenResults(this.hidden);
    }
    /**
     * Life-cycle method
     * subscribe to:
     * - result previews
     * - user defined hidden results
     * - dialog events
     */
    ngOnInit() {
        this.translations = this.translatesService.translations;
        const { hiddenResults$, previews$ } = this.reportSerivce;
        previews$.pipe(untilDestroy(this)).subscribe(results => (this.results = results.reverse()));
        hiddenResults$.pipe(take(1)).subscribe(hidden => {
            this.hidden = [...hidden];
        });
        this.dialogRef
            .beforeClosed()
            .pipe(truthy())
            .subscribe(() => this.saveChanges());
    }
    /**
     * Life-cycle method
     * empty for `untilDestroy` rxjs operator
     */
    ngOnDestroy() { }
}
ResultsFilterDialogComponent.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "13.3.3", ngImport: i0, type: ResultsFilterDialogComponent, deps: [{ token: i1.CopyleaksTranslateService }, { token: i2.MatDialogRef }, { token: i3.DirectionService }, { token: MAT_DIALOG_DATA }, { token: i4.LiveAnnouncer }], target: i0.ɵɵFactoryTarget.Component });
ResultsFilterDialogComponent.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "12.0.0", version: "13.3.3", type: ResultsFilterDialogComponent, selector: "cr-results-filter-dialog", ngImport: i0, template: "<div mat-dialog-title>{{ translations?.FILTER_DIALOG?.TITLE || 'Results Filter' }}</div>\n<mat-form-field floatLabel=\"never\">\n\t<mat-icon matSuffix>search</mat-icon>\n\t<input\n\t\taria-label=\"Search for specific result.\"\n\t\tmatInput\n\t\t[placeholder]=\"translations?.FILTER_DIALOG?.SEARCH_PLACHOLDER || 'Filter By Results'\"\n\t\ttype=\"search\"\n\t\t[(ngModel)]=\"query\" />\n</mat-form-field>\n<mat-dialog-content>\n\t<div\n\t\tresult\n\t\t*ngFor=\"let result of results | search : 'title,id' : query\"\n\t\tfxLayout=\"row\"\n\t\tfxLayoutAlign=\"space-between center\">\n\t\t<div fxLayout=\"column\" class=\"result-item-meta-data-container\">\n\t\t\t<span class=\"result-item-meta-data-title\">{{ result.title }}</span>\n\t\t\t<ng-container *ngIf=\"result?.url\">\n\t\t\t\t<a [href]=\"result?.url\" target=\"_blank\" aria-label=\"Result source link.\" class=\"result-item-meta-data-link\">\n\t\t\t\t\t{{ result?.url }}\n\t\t\t\t</a>\n\t\t\t</ng-container>\n\t\t\t<ng-container *ngIf=\"!result?.url && result?.metadata?.filename\">\n\t\t\t\t{{ result?.metadata?.filename }}\n\t\t\t</ng-container>\n\t\t</div>\n\t\t<mat-checkbox\n\t\t\tclass=\"checkbox-outline-size\"\n\t\t\t[checked]=\"!isHidden(result)\"\n\t\t\t(change)=\"toggleResult(result)\"\n\t\t\t[aria-label]=\"\n\t\t\t\tisHidden(result) ? 'Check to include this result' : 'Un-check to exclude this result'\n\t\t\t\"></mat-checkbox>\n\t</div>\n</mat-dialog-content>\n<div fxLayout=\"row\" fxLayoutAlign=\"space-between center\" style=\"padding-top: 1em\">\n\t<button\n\t\tmat-button\n\t\tclass=\"check-uncheck-all-btn\"\n\t\t(click)=\"checkAll()\"\n\t\taria-label=\"Includes or excludes all results from report.\"\n\t\tdisableRipple>\n\t\t{{\n\t\t\thidden.length === results.length\n\t\t\t\t? translations?.FILTER_DIALOG?.CHECK_ALL || 'check all'\n\t\t\t\t: translations?.FILTER_DIALOG?.UNCHECK_ALL || 'uncheck all'\n\t\t}}\n\t</button>\n\t<button mat-raised-button (click)=\"close(true)\" color=\"primary\" aria-label=\"Saves the filtered results.\">\n\t\t{{ translations?.SHARED?.SAVE || 'SAVE' }}\n\t</button>\n</div>\n\n<button\n\tclose\n\tmat-icon-button\n\t(click)=\"close()\"\n\t[class]=\"'close-' + directionService.dir\"\n\taria-label=\"Closes the results filter dialog.\">\n\t<mat-icon svgIcon=\"close_black_color\"></mat-icon>\n</button>\n", styles: [".sat-tooltip{color:#fff;border-radius:4px;margin:14px;max-width:250px;padding:.5em;overflow:hidden;text-overflow:ellipsis;background:rgba(0,0,0,.8)}.identical{background-color:#ff796e}.minor-changes{background-color:#ff9a9a}.related{background-color:#ffd9b0}.omitted{background-color:#fff}.text-identical{color:#ff796e}.text-minor-changes{color:#ff9a9a}.text-related{color:#ffd9b0}.dot{border:1px solid #171717;width:1.5em;min-width:1.5em;min-height:1.5em;height:1.5em;border-radius:50%}@media screen and (max-width: 959px){.dot{width:1em;min-width:1em;min-height:1em;height:1em}}.copyleaks-report-dialog .mat-dialog-container{padding:0}:host{display:flex;flex-flow:column nowrap;position:relative}mat-form-field{margin-bottom:0;width:100%}[result]:hover{background:rgba(0,0,0,.04)}[result] mat-pseudo-checkbox{margin-left:1em}[result] p{flex:1;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}[button-link]{cursor:pointer;text-transform:capitalize}[check-item]{cursor:pointer;margin-bottom:.5em;white-space:nowrap;flex:1;overflow:hidden;text-overflow:ellipsis}[check-item]:last-child{margin-top:0}[close]{position:absolute;margin-top:-1em;margin-right:-1em;top:0;right:0}.close-rtl{right:unset;left:-16px;top:-6px}@media screen and (min-width: 960px){mat-dialog-content{height:50vh;width:60vh}}.check-uncheck-all-btn{color:#00e;font-weight:400;font-size:14px;text-decoration:underline;text-transform:capitalize}.check-uncheck-all-btn ::ng-deep .mat-button-focus-overlay{background-color:transparent!important}.cdk-keyboard-focused{outline:2px solid black!important}.result-item-meta-data-container{padding:2px;overflow:hidden}.result-item-meta-data-container .result-item-meta-data-link{max-width:695px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.checkbox-outline-size{height:16px;line-height:12px}\n"], components: [{ type: i5.MatFormField, selector: "mat-form-field", inputs: ["color", "appearance", "hideRequiredMarker", "hintLabel", "floatLabel"], exportAs: ["matFormField"] }, { type: i6.MatIcon, selector: "mat-icon", inputs: ["color", "inline", "svgIcon", "fontSet", "fontIcon"], exportAs: ["matIcon"] }, { type: i7.MatCheckbox, selector: "mat-checkbox", inputs: ["disableRipple", "color", "tabIndex", "aria-label", "aria-labelledby", "aria-describedby", "id", "required", "labelPosition", "name", "value", "checked", "disabled", "indeterminate"], outputs: ["change", "indeterminateChange"], exportAs: ["matCheckbox"] }, { type: i8.MatButton, selector: "button[mat-button], button[mat-raised-button], button[mat-icon-button],             button[mat-fab], button[mat-mini-fab], button[mat-stroked-button],             button[mat-flat-button]", inputs: ["disabled", "disableRipple", "color"], exportAs: ["matButton"] }], directives: [{ type: i2.MatDialogTitle, selector: "[mat-dialog-title], [matDialogTitle]", inputs: ["id"], exportAs: ["matDialogTitle"] }, { type: i5.MatSuffix, selector: "[matSuffix]" }, { type: i9.MatInput, selector: "input[matInput], textarea[matInput], select[matNativeControl],      input[matNativeControl], textarea[matNativeControl]", inputs: ["disabled", "id", "placeholder", "name", "required", "type", "errorStateMatcher", "aria-describedby", "value", "readonly"], exportAs: ["matInput"] }, { type: i10.DefaultValueAccessor, selector: "input:not([type=checkbox])[formControlName],textarea[formControlName],input:not([type=checkbox])[formControl],textarea[formControl],input:not([type=checkbox])[ngModel],textarea[ngModel],[ngDefaultControl]" }, { type: i10.NgControlStatus, selector: "[formControlName],[ngModel],[formControl]" }, { type: i10.NgModel, selector: "[ngModel]:not([formControlName]):not([formControl])", inputs: ["name", "disabled", "ngModel", "ngModelOptions"], outputs: ["ngModelChange"], exportAs: ["ngModel"] }, { type: i2.MatDialogContent, selector: "[mat-dialog-content], mat-dialog-content, [matDialogContent]" }, { type: i11.NgForOf, selector: "[ngFor][ngForOf]", inputs: ["ngForOf", "ngForTrackBy", "ngForTemplate"] }, { type: i12.DefaultLayoutDirective, selector: "  [fxLayout], [fxLayout.xs], [fxLayout.sm], [fxLayout.md],  [fxLayout.lg], [fxLayout.xl], [fxLayout.lt-sm], [fxLayout.lt-md],  [fxLayout.lt-lg], [fxLayout.lt-xl], [fxLayout.gt-xs], [fxLayout.gt-sm],  [fxLayout.gt-md], [fxLayout.gt-lg]", inputs: ["fxLayout", "fxLayout.xs", "fxLayout.sm", "fxLayout.md", "fxLayout.lg", "fxLayout.xl", "fxLayout.lt-sm", "fxLayout.lt-md", "fxLayout.lt-lg", "fxLayout.lt-xl", "fxLayout.gt-xs", "fxLayout.gt-sm", "fxLayout.gt-md", "fxLayout.gt-lg"] }, { type: i12.DefaultLayoutAlignDirective, selector: "  [fxLayoutAlign], [fxLayoutAlign.xs], [fxLayoutAlign.sm], [fxLayoutAlign.md],  [fxLayoutAlign.lg], [fxLayoutAlign.xl], [fxLayoutAlign.lt-sm], [fxLayoutAlign.lt-md],  [fxLayoutAlign.lt-lg], [fxLayoutAlign.lt-xl], [fxLayoutAlign.gt-xs], [fxLayoutAlign.gt-sm],  [fxLayoutAlign.gt-md], [fxLayoutAlign.gt-lg]", inputs: ["fxLayoutAlign", "fxLayoutAlign.xs", "fxLayoutAlign.sm", "fxLayoutAlign.md", "fxLayoutAlign.lg", "fxLayoutAlign.xl", "fxLayoutAlign.lt-sm", "fxLayoutAlign.lt-md", "fxLayoutAlign.lt-lg", "fxLayoutAlign.lt-xl", "fxLayoutAlign.gt-xs", "fxLayoutAlign.gt-sm", "fxLayoutAlign.gt-md", "fxLayoutAlign.gt-lg"] }, { type: i11.NgIf, selector: "[ngIf]", inputs: ["ngIf", "ngIfThen", "ngIfElse"] }], pipes: { "search": i13.SearchPipe } });
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "13.3.3", ngImport: i0, type: ResultsFilterDialogComponent, decorators: [{
            type: Component,
            args: [{ selector: 'cr-results-filter-dialog', template: "<div mat-dialog-title>{{ translations?.FILTER_DIALOG?.TITLE || 'Results Filter' }}</div>\n<mat-form-field floatLabel=\"never\">\n\t<mat-icon matSuffix>search</mat-icon>\n\t<input\n\t\taria-label=\"Search for specific result.\"\n\t\tmatInput\n\t\t[placeholder]=\"translations?.FILTER_DIALOG?.SEARCH_PLACHOLDER || 'Filter By Results'\"\n\t\ttype=\"search\"\n\t\t[(ngModel)]=\"query\" />\n</mat-form-field>\n<mat-dialog-content>\n\t<div\n\t\tresult\n\t\t*ngFor=\"let result of results | search : 'title,id' : query\"\n\t\tfxLayout=\"row\"\n\t\tfxLayoutAlign=\"space-between center\">\n\t\t<div fxLayout=\"column\" class=\"result-item-meta-data-container\">\n\t\t\t<span class=\"result-item-meta-data-title\">{{ result.title }}</span>\n\t\t\t<ng-container *ngIf=\"result?.url\">\n\t\t\t\t<a [href]=\"result?.url\" target=\"_blank\" aria-label=\"Result source link.\" class=\"result-item-meta-data-link\">\n\t\t\t\t\t{{ result?.url }}\n\t\t\t\t</a>\n\t\t\t</ng-container>\n\t\t\t<ng-container *ngIf=\"!result?.url && result?.metadata?.filename\">\n\t\t\t\t{{ result?.metadata?.filename }}\n\t\t\t</ng-container>\n\t\t</div>\n\t\t<mat-checkbox\n\t\t\tclass=\"checkbox-outline-size\"\n\t\t\t[checked]=\"!isHidden(result)\"\n\t\t\t(change)=\"toggleResult(result)\"\n\t\t\t[aria-label]=\"\n\t\t\t\tisHidden(result) ? 'Check to include this result' : 'Un-check to exclude this result'\n\t\t\t\"></mat-checkbox>\n\t</div>\n</mat-dialog-content>\n<div fxLayout=\"row\" fxLayoutAlign=\"space-between center\" style=\"padding-top: 1em\">\n\t<button\n\t\tmat-button\n\t\tclass=\"check-uncheck-all-btn\"\n\t\t(click)=\"checkAll()\"\n\t\taria-label=\"Includes or excludes all results from report.\"\n\t\tdisableRipple>\n\t\t{{\n\t\t\thidden.length === results.length\n\t\t\t\t? translations?.FILTER_DIALOG?.CHECK_ALL || 'check all'\n\t\t\t\t: translations?.FILTER_DIALOG?.UNCHECK_ALL || 'uncheck all'\n\t\t}}\n\t</button>\n\t<button mat-raised-button (click)=\"close(true)\" color=\"primary\" aria-label=\"Saves the filtered results.\">\n\t\t{{ translations?.SHARED?.SAVE || 'SAVE' }}\n\t</button>\n</div>\n\n<button\n\tclose\n\tmat-icon-button\n\t(click)=\"close()\"\n\t[class]=\"'close-' + directionService.dir\"\n\taria-label=\"Closes the results filter dialog.\">\n\t<mat-icon svgIcon=\"close_black_color\"></mat-icon>\n</button>\n", styles: [".sat-tooltip{color:#fff;border-radius:4px;margin:14px;max-width:250px;padding:.5em;overflow:hidden;text-overflow:ellipsis;background:rgba(0,0,0,.8)}.identical{background-color:#ff796e}.minor-changes{background-color:#ff9a9a}.related{background-color:#ffd9b0}.omitted{background-color:#fff}.text-identical{color:#ff796e}.text-minor-changes{color:#ff9a9a}.text-related{color:#ffd9b0}.dot{border:1px solid #171717;width:1.5em;min-width:1.5em;min-height:1.5em;height:1.5em;border-radius:50%}@media screen and (max-width: 959px){.dot{width:1em;min-width:1em;min-height:1em;height:1em}}.copyleaks-report-dialog .mat-dialog-container{padding:0}:host{display:flex;flex-flow:column nowrap;position:relative}mat-form-field{margin-bottom:0;width:100%}[result]:hover{background:rgba(0,0,0,.04)}[result] mat-pseudo-checkbox{margin-left:1em}[result] p{flex:1;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}[button-link]{cursor:pointer;text-transform:capitalize}[check-item]{cursor:pointer;margin-bottom:.5em;white-space:nowrap;flex:1;overflow:hidden;text-overflow:ellipsis}[check-item]:last-child{margin-top:0}[close]{position:absolute;margin-top:-1em;margin-right:-1em;top:0;right:0}.close-rtl{right:unset;left:-16px;top:-6px}@media screen and (min-width: 960px){mat-dialog-content{height:50vh;width:60vh}}.check-uncheck-all-btn{color:#00e;font-weight:400;font-size:14px;text-decoration:underline;text-transform:capitalize}.check-uncheck-all-btn ::ng-deep .mat-button-focus-overlay{background-color:transparent!important}.cdk-keyboard-focused{outline:2px solid black!important}.result-item-meta-data-container{padding:2px;overflow:hidden}.result-item-meta-data-container .result-item-meta-data-link{max-width:695px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.checkbox-outline-size{height:16px;line-height:12px}\n"] }]
        }], ctorParameters: function () { return [{ type: i1.CopyleaksTranslateService }, { type: i2.MatDialogRef }, { type: i3.DirectionService }, { type: i14.ReportService, decorators: [{
                    type: Inject,
                    args: [MAT_DIALOG_DATA]
                }] }, { type: i4.LiveAnnouncer }]; } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicmVzdWx0cy1maWx0ZXItZGlhbG9nLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uLy4uLy4uL3Byb2plY3RzL3BsYWdpYXJpc20tcmVwb3J0L3NyYy9saWIvcGxhZ2lhcmlzbS1yZXBvcnQvY29tcG9uZW50cy9yZXN1bHRzLWZpbHRlci1kaWFsb2cvcmVzdWx0cy1maWx0ZXItZGlhbG9nLmNvbXBvbmVudC50cyIsIi4uLy4uLy4uLy4uLy4uLy4uLy4uL3Byb2plY3RzL3BsYWdpYXJpc20tcmVwb3J0L3NyYy9saWIvcGxhZ2lhcmlzbS1yZXBvcnQvY29tcG9uZW50cy9yZXN1bHRzLWZpbHRlci1kaWFsb2cvcmVzdWx0cy1maWx0ZXItZGlhbG9nLmNvbXBvbmVudC5odG1sIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBRSxTQUFTLEVBQUUsTUFBTSxFQUFxQixNQUFNLGVBQWUsQ0FBQztBQUNyRSxPQUFPLEVBQWdCLGVBQWUsRUFBRSxNQUFNLDBCQUEwQixDQUFDO0FBRXpFLE9BQU8sRUFBRSxJQUFJLEVBQUUsTUFBTSxnQkFBZ0IsQ0FBQztBQUN0QyxPQUFPLEVBQUUsWUFBWSxFQUFFLE1BQU0sd0NBQXdDLENBQUM7QUFHdEUsT0FBTyxFQUFFLE1BQU0sRUFBRSxNQUFNLHVCQUF1QixDQUFDOzs7Ozs7Ozs7Ozs7Ozs7O0FBVS9DLE1BQU0sT0FBTyw0QkFBNEI7SUFTeEMsWUFDUyxpQkFBNEMsRUFDNUMsU0FBcUQsRUFDdEQsZ0JBQWtDLEVBQ1IsYUFBNEIsRUFDckQsU0FBd0I7UUFKeEIsc0JBQWlCLEdBQWpCLGlCQUFpQixDQUEyQjtRQUM1QyxjQUFTLEdBQVQsU0FBUyxDQUE0QztRQUN0RCxxQkFBZ0IsR0FBaEIsZ0JBQWdCLENBQWtCO1FBQ1Isa0JBQWEsR0FBYixhQUFhLENBQWU7UUFDckQsY0FBUyxHQUFULFNBQVMsQ0FBZTtRQWJqQyxVQUFLLEdBQUcsRUFBRSxDQUFDO1FBQ1gs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bEMsTUFBTTsyQkFBQyxlQUFlIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQ29tcG9uZW50LCBJbmplY3QsIE9uRGVzdHJveSwgT25Jbml0IH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQgeyBNYXREaWFsb2dSZWYsIE1BVF9ESUFMT0dfREFUQSB9IGZyb20gJ0Bhbmd1bGFyL21hdGVyaWFsL2RpYWxvZyc7XG5pbXBvcnQgeyBTdWJzY3JpcHRpb24gfSBmcm9tICdyeGpzJztcbmltcG9ydCB7IHRha2UgfSBmcm9tICdyeGpzL29wZXJhdG9ycyc7XG5pbXBvcnQgeyB1bnRpbERlc3Ryb3kgfSBmcm9tICcuLi8uLi8uLi9zaGFyZWQvb3BlcmF0b3JzL3VudGlsRGVzdHJveSc7XG5pbXBvcnQgeyBSZXN1bHRQcmV2aWV3IH0gZnJvbSAnLi4vLi4vbW9kZWxzJztcbmltcG9ydCB7IFJlcG9ydFNlcnZpY2UgfSBmcm9tICcuLi8uLi9zZXJ2aWNlcy9yZXBvcnQuc2VydmljZSc7XG5pbXBvcnQgeyB0cnV0aHkgfSBmcm9tICcuLi8uLi91dGlscy9vcGVyYXRvcnMnO1xuaW1wb3J0IHsgQ29weWxlYWtzVHJhbnNsYXRlU2VydmljZSwgQ29weWxlYWtzVHJhbnNsYXRpb25zIH0gZnJvbSAnLi4vLi4vc2VydmljZXMvY29weWxlYWtzLXRyYW5zbGF0ZS5zZXJ2aWNlJztcbmltcG9ydCB7IERpcmVjdGlvblNlcnZpY2UgfSBmcm9tICcuLi8uLi9zZXJ2aWNlcy9kaXJlY3Rpb24uc2VydmljZSc7XG5pbXBvcnQgeyBMaXZlQW5ub3VuY2VyIH0gZnJvbSAnQGFuZ3VsYXIvY2RrL2ExMXknO1xuXG5AQ29tcG9uZW50KHtcblx0c2VsZWN0b3I6ICdjci1yZXN1bHRzLWZpbHRlci1kaWFsb2cnLFxuXHR0ZW1wbGF0ZVVybDogJy4vcmVzdWx0cy1maWx0ZXItZGlhbG9nLmNvbXBvbmVudC5odG1sJyxcblx0c3R5bGVVcmxzOiBbJy4vcmVzdWx0cy1maWx0ZXItZGlhbG9nLmNvbXBvbmVudC5zY3NzJ10sXG59KVxuZXhwb3J0IGNsYXNzIFJlc3VsdHNGaWx0ZXJEaWFsb2dDb21wb25lbnQgaW1wbGVtZW50cyBPbkluaXQsIE9uRGVzdHJveSB7XG5cdHF1ZXJ5ID0gJyc7XG5cdGhpZGRlbjogc3RyaW5nW10gPSBbXTtcblx0aGlkZGVuU3Vic2NyaXB0aW9uOiBTdWJzY3JpcHRpb247XG5cdHJlc3VsdHM6IFJlc3VsdFByZXZpZXdbXTtcblx0dHJhbnNsYXRpb25zOiBDb3B5bGVha3NUcmFuc2xhdGlvbnM7XG5cblx0Y2hlY2tlZEFsbFJlc3VsdHMgPSBmYWxzZTtcblxuXHRjb25zdHJ1Y3Rvcihcblx0XHRwcml2YXRlIHRyYW5zbGF0ZXNTZXJ2aWNlOiBDb3B5bGVha3NUcmFuc2xhdGVTZXJ2aWNlLFxuXHRcdHByaXZhdGUgZGlhbG9nUmVmOiBNYXREaWFsb2dSZWY8UmVzdWx0c0ZpbHRlckRpYWxvZ0NvbXBvbmVudD4sXG5cdFx0cHVibGljIGRpcmVjdGlvblNlcnZpY2U6IERpcmVjdGlvblNlcnZpY2UsXG5cdFx0QEluamVjdChNQVRfRElBTE9HX0RBVEEpIHByaXZhdGUgcmVwb3J0U2VyaXZjZTogUmVwb3J0U2VydmljZSxcblx0XHRwcml2YXRlIGFubm91bmNlcjogTGl2ZUFubm91bmNlclxuXHQpIHt9XG5cblx0LyoqXG5cdCAqIENoZWNrcyB3aGV0aGVyIHRoZSBoaWRkZW4gcmVzdWx0cyBjb250YWluIGEgYHJlc3VsdGBcblx0ICogQHBhcmFtIHJlc3VsdCB0aGUgcmVzdWx0IHRvIHRlc3Rcblx0ICovXG5cdGlzSGlkZGVuKHJlc3VsdDogUmVzdWx0UHJldmlldyk6IGJvb2xlYW4ge1xuXHRcdHJldHVybiB0aGlzLmhpZGRlbi5pbmNsdWRlcyhyZXN1bHQuaWQpO1xuXHR9XG5cblx0LyoqXG5cdCAqIEFkZHMgb3IgcmVtb3ZlcyB0aGUgYHJlc3VsdGAgZnJvbSB0aGUgaGlkZGVuIHJlc3VsdHMgbGlzdCBlc3NlbnRpYWx5IGNoZWNrcyBvciB1bmNoZWNrcyBpdFxuXHQgKiBAcGFyYW0gcmVzdWx0IHRoZSByZXN1bHQgdG8gY2hlY2svdW5jaGVja1xuXHQgKi9cblx0dG9nZ2xlUmVzdWx0KHJlc3VsdDogUmVzdWx0UHJldmlldykge1xuXHRcdGNvbnN0IGluZGV4ID0gdGhpcy5oaWRkZW4uaW5kZXhPZihyZXN1bHQuaWQpO1xuXHRcdGlmIChpbmRleCA+IC0xKSB7XG5cdFx0XHR0aGlzLmhpZGRlbi5zcGxpY2UoaW5kZXgsIDEpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHR0aGlzLmhpZGRlbi5wdXNoKHJlc3VsdC5pZCk7XG5cdFx0fVxuXHR9XG5cdC8qKlxuXHQgKiBDaGVja3Mgb3IgdW5jaGVja3MgYWxsIHJlc3VsdHNcblx0ICovXG5cdGNoZWNrQWxsKCkge1xuXHRcdGlmICh0aGlzLmhpZGRlbi5sZW5ndGggIT09IHRoaXMucmVzdWx0cy5sZW5ndGgpIHtcblx0XHRcdHRoaXMuaGlkZGVuID0gWy4uLnRoaXMucmVzdWx0cy5tYXAociA9PiByLmlkKV07XG5cdFx0fSBlbHNlIHtcblx0XHRcdHRoaXMuaGlkZGVuID0gW107XG5cdFx0fVxuXHRcdHRoaXMuY2hlY2tlZEFsbFJlc3VsdHMgPSAhdGhpcy5jaGVja2VkQWxsUmVzdWx0cztcblxuXHRcdHRoaXMuYW5ub3VuY2VyLmFubm91bmNlKHRoaXMuY2hlY2tlZEFsbFJlc3VsdHMgPyAnQWxsIHJlc3VsdHMgdW5jaGVja2VkJyA6ICdBbGwgcmVzdWx0cyBjaGVja2VkJywgJ2Fzc2VydGl2ZScpO1xuXHR9XG5cblx0LyoqXG5cdCAqIENsb3NlcyB0aGUgZGlhbG9nIHdoaWxlIGluZGljYXRpbmcgd2hldGhlciB0byBgc2F2ZWAgY2hhbmdlcyBvciBub3QuXG5cdCAqL1xuXHRjbG9zZShzYXZlPzogYm9vbGVhbikge1xuXHRcdHRoaXMuZGlhbG9nUmVmLmNsb3NlKHNhdmUpO1xuXHR9XG5cblx0LyoqXG5cdCAqIFNhdmVzIHRoZSBoaWRkZW4gcmVzdWx0cyBjaGFuZ2VzXG5cdCAqL1xuXHRzYXZlQ2hhbmdlcygpIHtcblx0XHR0aGlzLnJlcG9ydFNlcml2Y2Uuc2V0SGlkZGVuUmVzdWx0cyh0aGlzLmhpZGRlbik7XG5cdH1cblxuXHQvKipcblx0ICogTGlmZS1jeWNsZSBtZXRob2Rcblx0ICogc3Vic2NyaWJlIHRvOlxuXHQgKiAtIHJlc3VsdCBwcmV2aWV3c1xuXHQgKiAtIHVzZXIgZGVmaW5lZCBoaWRkZW4gcmVzdWx0c1xuXHQgKiAtIGRpYWxvZyBldmVudHNcblx0ICovXG5cdG5nT25Jbml0KCkge1xuXHRcdHRoaXMudHJhbnNsYXRpb25zID0gdGhpcy50cmFuc2xhdGVzU2VydmljZS50cmFuc2xhdGlvbnM7XG5cdFx0Y29uc3QgeyBoaWRkZW5SZXN1bHRzJCwgcHJldmlld3MkIH0gPSB0aGlzLnJlcG9ydFNlcml2Y2U7XG5cdFx0cHJldmlld3MkLnBpcGUodW50aWxEZXN0cm95KHRoaXMpKS5zdWJzY3JpYmUocmVzdWx0cyA9PiAodGhpcy5yZXN1bHRzID0gcmVzdWx0cy5yZXZlcnNlKCkpKTtcblx0XHRoaWRkZW5SZXN1bHRzJC5waXBlKHRha2UoMSkpLnN1YnNjcmliZShoaWRkZW4gPT4ge1xuXHRcdFx0dGhpcy5oaWRkZW4gPSBbLi4uaGlkZGVuXTtcblx0XHR9KTtcblx0XHR0aGlzLmRpYWxvZ1JlZlxuXHRcdFx0LmJlZm9yZUNsb3NlZCgpXG5cdFx0XHQucGlwZSh0cnV0aHkoKSlcblx0XHRcdC5zdWJzY3JpYmUoKCkgPT4gdGhpcy5zYXZlQ2hhbmdlcygpKTtcblx0fVxuXHQvKipcblx0ICogTGlmZS1jeWNsZSBtZXRob2Rcblx0ICogZW1wdHkgZm9yIGB1bnRpbERlc3Ryb3lgIHJ4anMgb3BlcmF0b3Jcblx0ICovXG5cdG5nT25EZXN0cm95KCkge31cbn1cbiIsIjxkaXYgbWF0LWRpYWxvZy10aXRsZT57eyB0cmFuc2xhdGlvbnM/LkZJTFRFUl9ESUFMT0c/LlRJVExFIHx8ICdSZXN1bHRzIEZpbHRlcicgfX08L2Rpdj5cbjxtYXQtZm9ybS1maWVsZCBmbG9hdExhYmVsPVwibmV2ZXJcIj5cblx0PG1hdC1pY29uIG1hdFN1ZmZpeD5zZWFyY2g8L21hdC1pY29uPlxuXHQ8aW5wdXRcblx0XHRhcmlhLWxhYmVsPVwiU2VhcmNoIGZvciBzcGVjaWZpYyByZXN1bHQuXCJcblx0XHRtYXRJbnB1dFxuXHRcdFtwbGFjZWhvbGRlcl09XCJ0cmFuc2xhdGlvbnM/LkZJTFRFUl9ESUFMT0c/LlNFQVJDSF9QTEFDSE9MREVSIHx8ICdGaWx0ZXIgQnkgUmVzdWx0cydcIlxuXHRcdHR5cGU9XCJzZWFyY2hcIlxuXHRcdFsobmdNb2RlbCldPVwicXVlcnlcIiAvPlxuPC9tYXQtZm9ybS1maWVsZD5cbjxtYXQtZGlhbG9nLWNvbnRlbnQ+XG5cdDxkaXZcblx0XHRyZXN1bHRcblx0XHQqbmdGb3I9XCJsZXQgcmVzdWx0IG9mIHJlc3VsdHMgfCBzZWFyY2ggOiAndGl0bGUsaWQnIDogcXVlcnlcIlxuXHRcdGZ4TGF5b3V0PVwicm93XCJcblx0XHRmeExheW91dEFsaWduPVwic3BhY2UtYmV0d2VlbiBjZW50ZXJcIj5cblx0XHQ8ZGl2IGZ4TGF5b3V0PVwiY29sdW1uXCIgY2xhc3M9XCJyZXN1bHQtaXRlbS1tZXRhLWRhdGEtY29udGFpbmVyXCI+XG5cdFx0XHQ8c3BhbiBjbGFzcz1cInJlc3VsdC1pdGVtLW1ldGEtZGF0YS10aXRsZVwiPnt7IHJlc3VsdC50aXRsZSB9fTwvc3Bhbj5cblx0XHRcdDxuZy1jb250YWluZXIgKm5nSWY9XCJyZXN1bHQ/LnVybFwiPlxuXHRcdFx0XHQ8YSBbaHJlZl09XCJyZXN1bHQ/LnVybFwiIHRhcmdldD1cIl9ibGFua1wiIGFyaWEtbGFiZWw9XCJSZXN1bHQgc291cmNlIGxpbmsuXCIgY2xhc3M9XCJyZXN1bHQtaXRlbS1tZXRhLWRhdGEtbGlua1wiPlxuXHRcdFx0XHRcdHt7IHJlc3VsdD8udXJsIH19XG5cdFx0XHRcdDwvYT5cblx0XHRcdDwvbmctY29udGFpbmVyPlxuXHRcdFx0PG5nLWNvbnRhaW5lciAqbmdJZj1cIiFyZXN1bHQ/LnVybCAmJiByZXN1bHQ/Lm1ldGFkYXRhPy5maWxlbmFtZVwiPlxuXHRcdFx0XHR7eyByZXN1bHQ/Lm1ldGFkYXRhPy5maWxlbmFtZSB9fVxuXHRcdFx0PC9uZy1jb250YWluZXI+XG5cdFx0PC9kaXY+XG5cdFx0PG1hdC1jaGVja2JveFxuXHRcdFx0Y2xhc3M9XCJjaGVja2JveC1vdXRsaW5lLXNpemVcIlxuXHRcdFx0W2NoZWNrZWRdPVwiIWlzSGlkZGVuKHJlc3VsdClcIlxuXHRcdFx0KGNoYW5nZSk9XCJ0b2dnbGVSZXN1bHQocmVzdWx0KVwiXG5cdFx0XHRbYXJpYS1sYWJlbF09XCJcblx0XHRcdFx0aXNIaWRkZW4ocmVzdWx0KSA/ICdDaGVjayB0byBpbmNsdWRlIHRoaXMgcmVzdWx0JyA6ICdVbi1jaGVjayB0byBleGNsdWRlIHRoaXMgcmVzdWx0J1xuXHRcdFx0XCI+PC9tYXQtY2hlY2tib3g+XG5cdDwvZGl2PlxuPC9tYXQtZGlhbG9nLWNvbnRlbnQ+XG48ZGl2IGZ4TGF5b3V0PVwicm93XCIgZnhMYXlvdXRBbGlnbj1cInNwYWNlLWJldHdlZW4gY2VudGVyXCIgc3R5bGU9XCJwYWRkaW5nLXRvcDogMWVtXCI+XG5cdDxidXR0b25cblx0XHRtYXQtYnV0dG9uXG5cdFx0Y2xhc3M9XCJjaGVjay11bmNoZWNrLWFsbC1idG5cIlxuXHRcdChjbGljayk9XCJjaGVja0FsbCgpXCJcblx0XHRhcmlhLWxhYmVsPVwiSW5jbHVkZXMgb3IgZXhjbHVkZXMgYWxsIHJlc3VsdHMgZnJvbSByZXBvcnQuXCJcblx0XHRkaXNhYmxlUmlwcGxlPlxuXHRcdHt7XG5cdFx0XHRoaWRkZW4ubGVuZ3RoID09PSByZXN1bHRzLmxlbmd0aFxuXHRcdFx0XHQ/IHRyYW5zbGF0aW9ucz8uRklMVEVSX0RJQUxPRz8uQ0hFQ0tfQUxMIHx8ICdjaGVjayBhbGwnXG5cdFx0XHRcdDogdHJhbnNsYXRpb25zPy5GSUxURVJfRElBTE9HPy5VTkNIRUNLX0FMTCB8fCAndW5jaGVjayBhbGwnXG5cdFx0fX1cblx0PC9idXR0b24+XG5cdDxidXR0b24gbWF0LXJhaXNlZC1idXR0b24gKGNsaWNrKT1cImNsb3NlKHRydWUpXCIgY29sb3I9XCJwcmltYXJ5XCIgYXJpYS1sYWJlbD1cIlNhdmVzIHRoZSBmaWx0ZXJlZCByZXN1bHRzLlwiPlxuXHRcdHt7IHRyYW5zbGF0aW9ucz8uU0hBUkVEPy5TQVZFIHx8ICdTQVZFJyB9fVxuXHQ8L2J1dHRvbj5cbjwvZGl2PlxuXG48YnV0dG9uXG5cdGNsb3NlXG5cdG1hdC1pY29uLWJ1dHRvblxuXHQoY2xpY2spPVwiY2xvc2UoKVwiXG5cdFtjbGFzc109XCInY2xvc2UtJyArIGRpcmVjdGlvblNlcnZpY2UuZGlyXCJcblx0YXJpYS1sYWJlbD1cIkNsb3NlcyB0aGUgcmVzdWx0cyBmaWx0ZXIgZGlhbG9nLlwiPlxuXHQ8bWF0LWljb24gc3ZnSWNvbj1cImNsb3NlX2JsYWNrX2NvbG9yXCI+PC9tYXQtaWNvbj5cbjwvYnV0dG9uPlxuIl19