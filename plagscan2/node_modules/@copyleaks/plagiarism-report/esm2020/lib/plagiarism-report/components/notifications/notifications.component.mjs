import { Component, Output, EventEmitter } from '@angular/core';
import { NotificationsDialogComponent } from '../notifications-dialog/notifications-dialog.component';
import { untilDestroy } from '../../../shared/operators/untilDestroy';
import { filter } from 'rxjs/operators';
import { CompleteResultNotificationAlertSeverity } from '../../models';
import { EReportViewModel } from '../../services/view-mode.service';
import { ALERTS } from '../../utils/constants';
import * as i0 from "@angular/core";
import * as i1 from "@angular/material/dialog";
import * as i2 from "../../services/view-mode.service";
import * as i3 from "../../services/report.service";
import * as i4 from "@angular/cdk/a11y";
import * as i5 from "@angular/material/button";
import * as i6 from "@angular/material/icon";
import * as i7 from "@angular/common";
import * as i8 from "@angular/flex-layout/extended";
export class NotificationsComponent {
    constructor(matDialog, viewModeService, reportService, announcer) {
        this.matDialog = matDialog;
        this.viewModeService = viewModeService;
        this.reportService = reportService;
        this.announcer = announcer;
        this.severities = CompleteResultNotificationAlertSeverity;
        this.eReportViewModel = EReportViewModel;
        this.severityChange = new EventEmitter();
    }
    /**
     * Life-cycle method
     */
    ngOnInit() {
        this.currentViewMode$ = this.viewModeService.reportViewMode$;
        this.reportService.completeResult$
            .pipe(untilDestroy(this), filter(c => !!c.notifications && !!c.notifications.alerts && !!c.notifications.alerts.length))
            .subscribe(completeResult => {
            const notifications = JSON.parse(JSON.stringify(completeResult.notifications));
            notifications.alerts = notifications.alerts.filter(n => n.code != ALERTS.SUSPECTED_AI_TEXT_DETECTED);
            if (notifications.alerts.length) {
                const alertSeverities = notifications.alerts.map(s => +s.severity);
                this.severity = Math.max(...alertSeverities);
                this.severityChange.emit(this.severity);
            }
        });
    }
    /**
     * shows the notification dialogs with the alerts
     */
    showNotificationsDialog() {
        this.matDialog.open(NotificationsDialogComponent, {
            autoFocus: false,
            maxWidth: '500px',
            data: this.reportService,
        });
    }
    /**
     * change view to alerts view
     */
    toggleView() {
        if (this.viewModeService.reportViewMode$.value !== EReportViewModel.Alerts) {
            this.reportService.configure({ viewMode: 'one-to-many' });
            this.viewModeService.changeViewMode$(EReportViewModel.Alerts);
        }
        else {
            this.viewModeService.changeViewMode$(EReportViewModel.ScanningResult);
        }
        this.announcer.announce('toggled', 'assertive');
    }
    /**
     * Life-cycle method
     * empty for `untilDestroy` rxjs operator
     */
    ngOnDestroy() { }
}
NotificationsComponent.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "13.3.3", ngImport: i0, type: NotificationsComponent, deps: [{ token: i1.MatDialog }, { token: i2.ViewModeService }, { token: i3.ReportService }, { token: i4.LiveAnnouncer }], target: i0.ɵɵFactoryTarget.Component });
NotificationsComponent.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "12.0.0", version: "13.3.3", type: NotificationsComponent, selector: "cr-notifications", outputs: { severityChange: "severityChange" }, ngImport: i0, template: "<ng-container *ngIf=\"severity\">\n\t<button\n\t\taria-label=\"Click to toggle alerts\"\n\t\tmat-icon-button\n\t\t(click)=\"toggleView()\"\n\t\tclass=\"btn-notifications-new\"\n\t\t[ngClass]=\"{\n\t\t\t'btn-notifications-error': severity == severities.High || severity == severities.VeryHigh,\n\t\t\t'btn-notifications-warning': severity == severities.Medium,\n\t\t\t'btn-enabled': (currentViewMode$ | async) == eReportViewModel.Alerts\n\t\t}\"\n\t\tdisableRipple>\n\t\t<ng-container [ngSwitch]=\"severity\">\n\t\t\t<mat-icon *ngSwitchCase=\"severities.Medium\">warning</mat-icon>\n\t\t\t<mat-icon *ngSwitchCase=\"severities.High\">error</mat-icon>\n\t\t\t<mat-icon *ngSwitchCase=\"severities.VeryHigh\">error</mat-icon>\n\t\t\t<mat-icon *ngSwitchDefault>info</mat-icon>\n\t\t</ng-container>\n\t\t<span style=\"font-size: 13px; text-transform: uppercase\">\n\t\t\t<ng-container *ngIf=\"(currentViewMode$ | async) == eReportViewModel.ScanningResult; else hideAlerts\">\n\t\t\t\tsee alerts\n\t\t\t</ng-container>\n\t\t\t<ng-template #hideAlerts>hide alerts</ng-template>\n\t\t</span>\n\t</button>\n</ng-container>\n", styles: [".btn-notifications-new{border:1px solid #17a1ff;border-radius:6px;width:-moz-fit-content;width:fit-content;height:auto;line-height:normal;font-weight:700;padding:0 12px 0 0}.btn-notifications-new mat-icon{font-size:30px;width:30px;height:30px;line-height:normal}.btn-notifications-new.btn-enabled{background-color:#17a1ff;color:#fff}.btn-notifications-error{border:1px solid red;color:red}.btn-notifications-error.btn-enabled{background-color:red;color:#fff}.btn-notifications-warning{border:1px solid orange;color:orange}.btn-notifications-warning.btn-enabled{background-color:orange;color:#fff}.cdk-keyboard-focused{outline:2px solid black!important}\n"], components: [{ type: i5.MatButton, selector: "button[mat-button], button[mat-raised-button], button[mat-icon-button],             button[mat-fab], button[mat-mini-fab], button[mat-stroked-button],             button[mat-flat-button]", inputs: ["disabled", "disableRipple", "color"], exportAs: ["matButton"] }, { type: i6.MatIcon, selector: "mat-icon", inputs: ["color", "inline", "svgIcon", "fontSet", "fontIcon"], exportAs: ["matIcon"] }], directives: [{ type: i7.NgIf, selector: "[ngIf]", inputs: ["ngIf", "ngIfThen", "ngIfElse"] }, { type: i7.NgClass, selector: "[ngClass]", inputs: ["class", "ngClass"] }, { type: i8.DefaultClassDirective, selector: "  [ngClass], [ngClass.xs], [ngClass.sm], [ngClass.md], [ngClass.lg], [ngClass.xl],  [ngClass.lt-sm], [ngClass.lt-md], [ngClass.lt-lg], [ngClass.lt-xl],  [ngClass.gt-xs], [ngClass.gt-sm], [ngClass.gt-md], [ngClass.gt-lg]", inputs: ["ngClass", "ngClass.xs", "ngClass.sm", "ngClass.md", "ngClass.lg", "ngClass.xl", "ngClass.lt-sm", "ngClass.lt-md", "ngClass.lt-lg", "ngClass.lt-xl", "ngClass.gt-xs", "ngClass.gt-sm", "ngClass.gt-md", "ngClass.gt-lg"] }, { type: i7.NgSwitch, selector: "[ngSwitch]", inputs: ["ngSwitch"] }, { type: i7.NgSwitchCase, selector: "[ngSwitchCase]", inputs: ["ngSwitchCase"] }, { type: i7.NgSwitchDefault, selector: "[ngSwitchDefault]" }], pipes: { "async": i7.AsyncPipe } });
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "13.3.3", ngImport: i0, type: NotificationsComponent, decorators: [{
            type: Component,
            args: [{ selector: 'cr-notifications', template: "<ng-container *ngIf=\"severity\">\n\t<button\n\t\taria-label=\"Click to toggle alerts\"\n\t\tmat-icon-button\n\t\t(click)=\"toggleView()\"\n\t\tclass=\"btn-notifications-new\"\n\t\t[ngClass]=\"{\n\t\t\t'btn-notifications-error': severity == severities.High || severity == severities.VeryHigh,\n\t\t\t'btn-notifications-warning': severity == severities.Medium,\n\t\t\t'btn-enabled': (currentViewMode$ | async) == eReportViewModel.Alerts\n\t\t}\"\n\t\tdisableRipple>\n\t\t<ng-container [ngSwitch]=\"severity\">\n\t\t\t<mat-icon *ngSwitchCase=\"severities.Medium\">warning</mat-icon>\n\t\t\t<mat-icon *ngSwitchCase=\"severities.High\">error</mat-icon>\n\t\t\t<mat-icon *ngSwitchCase=\"severities.VeryHigh\">error</mat-icon>\n\t\t\t<mat-icon *ngSwitchDefault>info</mat-icon>\n\t\t</ng-container>\n\t\t<span style=\"font-size: 13px; text-transform: uppercase\">\n\t\t\t<ng-container *ngIf=\"(currentViewMode$ | async) == eReportViewModel.ScanningResult; else hideAlerts\">\n\t\t\t\tsee alerts\n\t\t\t</ng-container>\n\t\t\t<ng-template #hideAlerts>hide alerts</ng-template>\n\t\t</span>\n\t</button>\n</ng-container>\n", styles: [".btn-notifications-new{border:1px solid #17a1ff;border-radius:6px;width:-moz-fit-content;width:fit-content;height:auto;line-height:normal;font-weight:700;padding:0 12px 0 0}.btn-notifications-new mat-icon{font-size:30px;width:30px;height:30px;line-height:normal}.btn-notifications-new.btn-enabled{background-color:#17a1ff;color:#fff}.btn-notifications-error{border:1px solid red;color:red}.btn-notifications-error.btn-enabled{background-color:red;color:#fff}.btn-notifications-warning{border:1px solid orange;color:orange}.btn-notifications-warning.btn-enabled{background-color:orange;color:#fff}.cdk-keyboard-focused{outline:2px solid black!important}\n"] }]
        }], ctorParameters: function () { return [{ type: i1.MatDialog }, { type: i2.ViewModeService }, { type: i3.ReportService }, { type: i4.LiveAnnouncer }]; }, propDecorators: { severityChange: [{
                type: Output
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibm90aWZpY2F0aW9ucy5jb21wb25lbnQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi8uLi8uLi9wcm9qZWN0cy9wbGFnaWFyaXNtLXJlcG9ydC9zcmMvbGliL3BsYWdpYXJpc20tcmVwb3J0L2NvbXBvbmVudHMvbm90aWZpY2F0aW9ucy9ub3RpZmljYXRpb25zLmNvbXBvbmVudC50cyIsIi4uLy4uLy4uLy4uLy4uLy4uLy4uL3Byb2plY3RzL3BsYWdpYXJpc20tcmVwb3J0L3NyYy9saWIvcGxhZ2lhcmlzbS1yZXBvcnQvY29tcG9uZW50cy9ub3RpZmljYXRpb25zL25vdGlmaWNhdGlvbnMuY29tcG9uZW50Lmh0bWwiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFFLFNBQVMsRUFBcUIsTUFBTSxFQUFFLFlBQVksRUFBRSxNQUFNLGVBQWUsQ0FBQztBQUVuRixPQUFPLEVBQUUsNEJBQTRCLEVBQUUsTUFBTSx3REFBd0QsQ0FBQztBQUV0RyxPQUFPLEVBQUUsWUFBWSxFQUFFLE1BQU0sd0NBQXdDLENBQUM7QUFDdEUsT0FBTyxFQUFFLE1BQU0sRUFBRSxNQUFNLGdCQUFnQixDQUFDO0FBQ3hDLE9BQU8sRUFBRSx1Q0FBdUMsRUFBRSxNQUFNLGNBQWMsQ0FBQztBQUN2RSxPQUFPLEVBQUUsZ0JBQWdCLEVBQW1CLE1BQU0sa0NBQWtDLENBQUM7QUFFckYsT0FBTyxFQUFFLE1BQU0sRUFBRSxNQUFNLHVCQUF1QixDQUFDOzs7Ozs7Ozs7O0FBTy9DLE1BQU0sT0FBTyxzQkFBc0I7SUFNbEMsWUFDUyxTQUFvQixFQUNwQixlQUFnQyxFQUNoQyxhQUE0QixFQUM1QixTQUF3QjtRQUh4QixjQUFTLEdBQVQsU0FBUyxDQUFXO1FBQ3BCLG9CQUFlLEdBQWYsZUFBZSxDQUFpQjtRQUNoQyxrQkFBYSxHQUFiLGFBQWEsQ0FBZTtRQUM1QixjQUFTLEdBQVQsU0FBUyxDQUFlO1FBUjFCLGVBQVUsR0FBRyx1Q0FBdUMsQ0FBQztRQUVyRCxxQkFBZ0IsR0FBRyxnQkFBZ0IsQ0FBQztRQUNqQyxtQkFBYyxHQUFHLElBQUksWUFBWSxFQUEyQyxDQUFDO0lBTXBGLENBQUM7SUFDSjs7T0FFRztJQUNILFFBQVE7UUFDUCxJQUFJLENBQUMsZ0JBQWdCLEdBQUcsSUFBSSxDQUFDLGVBQWUsQ0FBQyxlQUFlLENBQUM7UUFDN0QsSUFBSSxDQUFDLGFBQWEsQ0FBQyxlQUFlO2FBQ2hDLElBQUksQ0FDSixZQUFZLENBQUMsSUFBSSxDQUFDLEVBQ2xCLE1BQU0sQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsYUFBYSxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUMsYUFBYSxDQUFDLE1BQU0sSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDLGFBQWEsQ0FBQyxNQUFNLENBQUMsTUFBTSxDQUFDLENBQzdGO2FBQ0EsU0FBUyxDQUFDLGNBQWMsQ0FBQyxFQUFFO1lBQzNCLE1BQU0sYUFBYSxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxjQUFjLENBQUMsYUFBYSxDQUFDLENBQUMsQ0FBQztZQUMvRSxhQUFhLENBQUMsTUFBTSxHQUFHLGFBQWEsQ0FBQyxNQUFNLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLElBQUksSUFBSSxNQUFNLENBQUMsMEJBQTBCLENBQUMsQ0FBQztZQUNyRyxJQUFJLGFBQWEsQ0FBQyxNQUFNLENBQUMsTUFBTSxFQUFFO2dCQUNoQyxNQUFNLGVBQWUsR0FBRyxhQUFhLENBQUMsTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLFFBQVEsQ0FBQyxDQUFDO2dCQUNuRSxJQUFJLENBQUMsUUFBUSxHQUFHLElBQUksQ0FBQyxHQUFHLENBQUMsR0FBRyxlQUFlLENBQUMsQ0FBQztnQkFDN0MsSUFBSSxDQUFDLGNBQWMsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxDQUFDO2FBQ3hDO1FBQ0YsQ0FBQyxDQUFDLENBQUM7SUFDTCxDQUFDO0lBQ0Q7O09BRUc7SUFDSCx1QkFBdUI7UUFDdEIsSUFBSSxDQUFDLFNBQVMsQ0FBQyxJQUFJLENBQUMsNEJBQTRCLEVBQUU7WUFDakQsU0FBUyxFQUFFLEtBQUs7WUFDaEIsUUFBUSxFQUFFLE9BQU87WUFDakIsSUFBSSxFQUFFLElBQUksQ0FBQyxhQUFhO1NBQ3hCLENBQUMsQ0FBQztJQUNKLENBQUM7SUFDRDs7T0FFRztJQUNILFVBQVU7UUFDVCxJQUFJLElBQUksQ0FBQyxlQUFlLENBQUMsZUFBZSxDQUFDLEtBQUssS0FBSyxnQkFBZ0IsQ0FBQyxNQUFNLEVBQUU7WUFDM0UsSUFBSSxDQUFDLGFBQWEsQ0FBQyxTQUFTLENBQUMsRUFBRSxRQUFRLEVBQUUsYUFBYSxFQUFFLENBQUMsQ0FBQztZQUMxRCxJQUFJLENBQUMsZUFBZSxDQUFDLGVBQWUsQ0FBQyxnQkFBZ0IsQ0FBQyxNQUFNLENBQUMsQ0FBQztTQUM5RDthQUFNO1lBQ04sSUFBSSxDQUFDLGVBQWUsQ0FBQyxlQUFlLENBQUMsZ0JBQWdCLENBQUMsY0FBYyxDQUFDLENBQUM7U0FDdEU7UUFFRCxJQUFJLENBQUMsU0FBUyxDQUFDLFFBQVEsQ0FBQyxTQUFTLEVBQUUsV0FBVyxDQUFDLENBQUM7SUFDakQsQ0FBQztJQUNEOzs7T0FHRztJQUNILFdBQVcsS0FBSSxDQUFDOzttSEEzREosc0JBQXNCO3VHQUF0QixzQkFBc0IsdUdDaEJuQywybENBMEJBOzJGRFZhLHNCQUFzQjtrQkFMbEMsU0FBUzsrQkFDQyxrQkFBa0I7c0xBU2xCLGNBQWM7c0JBQXZCLE1BQU0iLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBDb21wb25lbnQsIE9uSW5pdCwgT25EZXN0cm95LCBPdXRwdXQsIEV2ZW50RW1pdHRlciB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHsgTWF0RGlhbG9nIH0gZnJvbSAnQGFuZ3VsYXIvbWF0ZXJpYWwvZGlhbG9nJztcbmltcG9ydCB7IE5vdGlmaWNhdGlvbnNEaWFsb2dDb21wb25lbnQgfSBmcm9tICcuLi9ub3RpZmljYXRpb25zLWRpYWxvZy9ub3RpZmljYXRpb25zLWRpYWxvZy5jb21wb25lbnQnO1xuaW1wb3J0IHsgUmVwb3J0U2VydmljZSB9IGZyb20gJy4uLy4uL3NlcnZpY2VzL3JlcG9ydC5zZXJ2aWNlJztcbmltcG9ydCB7IHVudGlsRGVzdHJveSB9IGZyb20gJy4uLy4uLy4uL3NoYXJlZC9vcGVyYXRvcnMvdW50aWxEZXN0cm95JztcbmltcG9ydCB7IGZpbHRlciB9IGZyb20gJ3J4anMvb3BlcmF0b3JzJztcbmltcG9ydCB7IENvbXBsZXRlUmVzdWx0Tm90aWZpY2F0aW9uQWxlcnRTZXZlcml0eSB9IGZyb20gJy4uLy4uL21vZGVscyc7XG5pbXBvcnQgeyBFUmVwb3J0Vmlld01vZGVsLCBWaWV3TW9kZVNlcnZpY2UgfSBmcm9tICcuLi8uLi9zZXJ2aWNlcy92aWV3LW1vZGUuc2VydmljZSc7XG5pbXBvcnQgeyBCZWhhdmlvclN1YmplY3QgfSBmcm9tICdyeGpzJztcbmltcG9ydCB7IEFMRVJUUyB9IGZyb20gJy4uLy4uL3V0aWxzL2NvbnN0YW50cyc7XG5pbXBvcnQgeyBMaXZlQW5ub3VuY2VyIH0gZnJvbSAnQGFuZ3VsYXIvY2RrL2ExMXknO1xuQENvbXBvbmVudCh7XG5cdHNlbGVjdG9yOiAnY3Itbm90aWZpY2F0aW9ucycsXG5cdHRlbXBsYXRlVXJsOiAnLi9ub3RpZmljYXRpb25zLmNvbXBvbmVudC5odG1sJyxcblx0c3R5bGVVcmxzOiBbJy4vbm90aWZpY2F0aW9ucy5jb21wb25lbnQuc2NzcyddLFxufSlcbmV4cG9ydCBjbGFzcyBOb3RpZmljYXRpb25zQ29tcG9uZW50IGltcGxlbWVudHMgT25Jbml0LCBPbkRlc3Ryb3kge1xuXHRwdWJsaWMgc2V2ZXJpdHk6IENvbXBsZXRlUmVzdWx0Tm90aWZpY2F0aW9uQWxlcnRTZXZlcml0eTtcblx0cHVibGljIHNldmVyaXRpZXMgPSBDb21wbGV0ZVJlc3VsdE5vdGlmaWNhdGlvbkFsZXJ0U2V2ZXJpdHk7XG5cdHB1YmxpYyBjdXJyZW50Vmlld01vZGUkOiBCZWhhdmlvclN1YmplY3Q8RVJlcG9ydFZpZXdNb2RlbD47XG5cdHB1YmxpYyBlUmVwb3J0Vmlld01vZGVsID0gRVJlcG9ydFZpZXdNb2RlbDtcblx0QE91dHB1dCgpIHNldmVyaXR5Q2hhbmdlID0gbmV3IEV2ZW50RW1pdHRlcjxDb21wbGV0ZVJlc3VsdE5vdGlmaWNhdGlvbkFsZXJ0U2V2ZXJpdHk+KCk7XG5cdGNvbnN0cnVjdG9yKFxuXHRcdHByaXZhdGUgbWF0RGlhbG9nOiBNYXREaWFsb2csXG5cdFx0cHJpdmF0ZSB2aWV3TW9kZVNlcnZpY2U6IFZpZXdNb2RlU2VydmljZSxcblx0XHRwcml2YXRlIHJlcG9ydFNlcnZpY2U6IFJlcG9ydFNlcnZpY2UsXG5cdFx0cHJpdmF0ZSBhbm5vdW5jZXI6IExpdmVBbm5vdW5jZXJcblx0KSB7fVxuXHQvKipcblx0ICogTGlmZS1jeWNsZSBtZXRob2Rcblx0ICovXG5cdG5nT25Jbml0KCkge1xuXHRcdHRoaXMuY3VycmVudFZpZXdNb2RlJCA9IHRoaXMudmlld01vZGVTZXJ2aWNlLnJlcG9ydFZpZXdNb2RlJDtcblx0XHR0aGlzLnJlcG9ydFNlcnZpY2UuY29tcGxldGVSZXN1bHQkXG5cdFx0XHQucGlwZShcblx0XHRcdFx0dW50aWxEZXN0cm95KHRoaXMpLFxuXHRcdFx0XHRmaWx0ZXIoYyA9PiAhIWMubm90aWZpY2F0aW9ucyAmJiAhIWMubm90aWZpY2F0aW9ucy5hbGVydHMgJiYgISFjLm5vdGlmaWNhdGlvbnMuYWxlcnRzLmxlbmd0aClcblx0XHRcdClcblx0XHRcdC5zdWJzY3JpYmUoY29tcGxldGVSZXN1bHQgPT4ge1xuXHRcdFx0XHRjb25zdCBub3RpZmljYXRpb25zID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShjb21wbGV0ZVJlc3VsdC5ub3RpZmljYXRpb25zKSk7XG5cdFx0XHRcdG5vdGlmaWNhdGlvbnMuYWxlcnRzID0gbm90aWZpY2F0aW9ucy5hbGVydHMuZmlsdGVyKG4gPT4gbi5jb2RlICE9IEFMRVJUUy5TVVNQRUNURURfQUlfVEVYVF9ERVRFQ1RFRCk7XG5cdFx0XHRcdGlmIChub3RpZmljYXRpb25zLmFsZXJ0cy5sZW5ndGgpIHtcblx0XHRcdFx0XHRjb25zdCBhbGVydFNldmVyaXRpZXMgPSBub3RpZmljYXRpb25zLmFsZXJ0cy5tYXAocyA9PiArcy5zZXZlcml0eSk7XG5cdFx0XHRcdFx0dGhpcy5zZXZlcml0eSA9IE1hdGgubWF4KC4uLmFsZXJ0U2V2ZXJpdGllcyk7XG5cdFx0XHRcdFx0dGhpcy5zZXZlcml0eUNoYW5nZS5lbWl0KHRoaXMuc2V2ZXJpdHkpO1xuXHRcdFx0XHR9XG5cdFx0XHR9KTtcblx0fVxuXHQvKipcblx0ICogc2hvd3MgdGhlIG5vdGlmaWNhdGlvbiBkaWFsb2dzIHdpdGggdGhlIGFsZXJ0c1xuXHQgKi9cblx0c2hvd05vdGlmaWNhdGlvbnNEaWFsb2coKSB7XG5cdFx0dGhpcy5tYXREaWFsb2cub3BlbihOb3RpZmljYXRpb25zRGlhbG9nQ29tcG9uZW50LCB7XG5cdFx0XHRhdXRvRm9jdXM6IGZhbHNlLFxuXHRcdFx0bWF4V2lkdGg6ICc1MDBweCcsXG5cdFx0XHRkYXRhOiB0aGlzLnJlcG9ydFNlcnZpY2UsXG5cdFx0fSk7XG5cdH1cblx0LyoqXG5cdCAqIGNoYW5nZSB2aWV3IHRvIGFsZXJ0cyB2aWV3XG5cdCAqL1xuXHR0b2dnbGVWaWV3KCkge1xuXHRcdGlmICh0aGlzLnZpZXdNb2RlU2VydmljZS5yZXBvcnRWaWV3TW9kZSQudmFsdWUgIT09IEVSZXBvcnRWaWV3TW9kZWwuQWxlcnRzKSB7XG5cdFx0XHR0aGlzLnJlcG9ydFNlcnZpY2UuY29uZmlndXJlKHsgdmlld01vZGU6ICdvbmUtdG8tbWFueScgfSk7XG5cdFx0XHR0aGlzLnZpZXdNb2RlU2VydmljZS5jaGFuZ2VWaWV3TW9kZSQoRVJlcG9ydFZpZXdNb2RlbC5BbGVydHMpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHR0aGlzLnZpZXdNb2RlU2VydmljZS5jaGFuZ2VWaWV3TW9kZSQoRVJlcG9ydFZpZXdNb2RlbC5TY2FubmluZ1Jlc3VsdCk7XG5cdFx0fVxuXG5cdFx0dGhpcy5hbm5vdW5jZXIuYW5ub3VuY2UoJ3RvZ2dsZWQnLCAnYXNzZXJ0aXZlJyk7XG5cdH1cblx0LyoqXG5cdCAqIExpZmUtY3ljbGUgbWV0aG9kXG5cdCAqIGVtcHR5IGZvciBgdW50aWxEZXN0cm95YCByeGpzIG9wZXJhdG9yXG5cdCAqL1xuXHRuZ09uRGVzdHJveSgpIHt9XG59XG4iLCI8bmctY29udGFpbmVyICpuZ0lmPVwic2V2ZXJpdHlcIj5cblx0PGJ1dHRvblxuXHRcdGFyaWEtbGFiZWw9XCJDbGljayB0byB0b2dnbGUgYWxlcnRzXCJcblx0XHRtYXQtaWNvbi1idXR0b25cblx0XHQoY2xpY2spPVwidG9nZ2xlVmlldygpXCJcblx0XHRjbGFzcz1cImJ0bi1ub3RpZmljYXRpb25zLW5ld1wiXG5cdFx0W25nQ2xhc3NdPVwie1xuXHRcdFx0J2J0bi1ub3RpZmljYXRpb25zLWVycm9yJzogc2V2ZXJpdHkgPT0gc2V2ZXJpdGllcy5IaWdoIHx8IHNldmVyaXR5ID09IHNldmVyaXRpZXMuVmVyeUhpZ2gsXG5cdFx0XHQnYnRuLW5vdGlmaWNhdGlvbnMtd2FybmluZyc6IHNldmVyaXR5ID09IHNldmVyaXRpZXMuTWVkaXVtLFxuXHRcdFx0J2J0bi1lbmFibGVkJzogKGN1cnJlbnRWaWV3TW9kZSQgfCBhc3luYykgPT0gZVJlcG9ydFZpZXdNb2RlbC5BbGVydHNcblx0XHR9XCJcblx0XHRkaXNhYmxlUmlwcGxlPlxuXHRcdDxuZy1jb250YWluZXIgW25nU3dpdGNoXT1cInNldmVyaXR5XCI+XG5cdFx0XHQ8bWF0LWljb24gKm5nU3dpdGNoQ2FzZT1cInNldmVyaXRpZXMuTWVkaXVtXCI+d2FybmluZzwvbWF0LWljb24+XG5cdFx0XHQ8bWF0LWljb24gKm5nU3dpdGNoQ2FzZT1cInNldmVyaXRpZXMuSGlnaFwiPmVycm9yPC9tYXQtaWNvbj5cblx0XHRcdDxtYXQtaWNvbiAqbmdTd2l0Y2hDYXNlPVwic2V2ZXJpdGllcy5WZXJ5SGlnaFwiPmVycm9yPC9tYXQtaWNvbj5cblx0XHRcdDxtYXQtaWNvbiAqbmdTd2l0Y2hEZWZhdWx0PmluZm88L21hdC1pY29uPlxuXHRcdDwvbmctY29udGFpbmVyPlxuXHRcdDxzcGFuIHN0eWxlPVwiZm9udC1zaXplOiAxM3B4OyB0ZXh0LXRyYW5zZm9ybTogdXBwZXJjYXNlXCI+XG5cdFx0XHQ8bmctY29udGFpbmVyICpuZ0lmPVwiKGN1cnJlbnRWaWV3TW9kZSQgfCBhc3luYykgPT0gZVJlcG9ydFZpZXdNb2RlbC5TY2FubmluZ1Jlc3VsdDsgZWxzZSBoaWRlQWxlcnRzXCI+XG5cdFx0XHRcdHNlZSBhbGVydHNcblx0XHRcdDwvbmctY29udGFpbmVyPlxuXHRcdFx0PG5nLXRlbXBsYXRlICNoaWRlQWxlcnRzPmhpZGUgYWxlcnRzPC9uZy10ZW1wbGF0ZT5cblx0XHQ8L3NwYW4+XG5cdDwvYnV0dG9uPlxuPC9uZy1jb250YWluZXI+XG4iXX0=